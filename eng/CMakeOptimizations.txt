# Optimization default flags
option(OPTIMIZE_DECREF "Optimize DECREF when ob_refcnt > 1" ON)
option(OPTIMIZE_IS "Optimize IS_OP" ON)
option(OPTIMIZE_INTERN_COMPARE "Optimize COMPARE_OP for intern values" ON)
option(OPTIMIZE_NATIVE_LOCALS "Optimize frame locals into native JIT locals" OFF)
option(OPTIMIZE_PUSH_FRAME "Optimize push/pop frame into inline instructions" ON)
option(OPTIMIZE_KNOWN_STORE_SUBSCR "Optimize STORE_SUBSCR for known types" ON)
option(OPTIMIZE_KNOWN_BINARY_SUBSCR "Optimize BINARY_SUBSCR for known types" ON)
option(OPTIMIZE_BINARY_FUNCTIONS "Optimize pairs of binary functions as a triple sequence" ON)
option(OPTIMIZE_ITERATORS "Optimize iterators of common types into inline instructions" ON)
option(OPTIMIZE_HASHED_NAMES "Optimize LOAD_NAME/STORE_NAME with precomputed hashes" ON)
option(OPTIMIZE_BINARY_SLICE "Combine BUILD_SLICE/BINARY_SUBSCR" ON)
option(OPTIMIZE_BUILTIN_METHODS "Optimize builtin method lookups" ON)
option(OPTIMIZE_TYPESLOT_LOOKUPS "Precompile typeslot lookups for binary operations" ON)
option(OPTIMIZE_FUNCTION_CALLS "Precompile method calls to builtin CFunctions" ON)
option(OPTIMIZE_LOAD_ATTR "Optimize LOAD_ATTR for known types" ON)
option(OPTIMIZE_METHOD_CALLS "Optimize LOAD_METHOD/CALL_METHOD" ON)
option(OPTIMIZE_COMPARE "Optimize COMPARE_OP" ON)

option(EE_DEBUG_CODE "Emit debug EE/JITted code" OFF)
option(DOTNET_PGO "Use .NET 6 PGO profiles" ON)


if (OPTIMIZE_DECREF)
    add_definitions(-DOPTIMIZE_DECREF=1)
else()
    add_definitions(-DOPTIMIZE_DECREF=0)
endif()

if (OPTIMIZE_IS)
    add_definitions(-DOPTIMIZE_IS=1)
else()
    add_definitions(-DOPTIMIZE_IS=0)
endif()

if (OPTIMIZE_INTERN_COMPARE)
    add_definitions(-DOPTIMIZE_INTERN_COMPARE=1)
else()
    add_definitions(-DOPTIMIZE_INTERN_COMPARE=0)
endif()

if (OPTIMIZE_NATIVE_LOCALS)
    add_definitions(-DOPTIMIZE_NATIVE_LOCALS=1)
else()
    add_definitions(-DOPTIMIZE_NATIVE_LOCALS=0)
endif()

if (OPTIMIZE_PUSH_FRAME)
    add_definitions(-DOPTIMIZE_PUSH_FRAME=1)
else()
    add_definitions(-DOPTIMIZE_PUSH_FRAME=0)
endif()

if (OPTIMIZE_KNOWN_STORE_SUBSCR)
    add_definitions(-DOPTIMIZE_KNOWN_STORE_SUBSCR=1)
else()
    add_definitions(-DOPTIMIZE_KNOWN_STORE_SUBSCR=0)
endif()

if (OPTIMIZE_KNOWN_BINARY_SUBSCR)
    add_definitions(-DOPTIMIZE_KNOWN_BINARY_SUBSCR=1)
else()
    add_definitions(-DOPTIMIZE_KNOWN_BINARY_SUBSCR=0)
endif()

if (OPTIMIZE_BINARY_FUNCTIONS)
    add_definitions(-DOPTIMIZE_BINARY_FUNCTIONS=1)
else()
    add_definitions(-DOPTIMIZE_BINARY_FUNCTIONS=0)
endif()

if (OPTIMIZE_ITERATORS)
    add_definitions(-DOPTIMIZE_ITERATORS=1)
else()
    add_definitions(-DOPTIMIZE_ITERATORS=0)
endif()

if (OPTIMIZE_HASHED_NAMES)
    add_definitions(-DOPTIMIZE_HASHED_NAMES=1)
else()
    add_definitions(-DOPTIMIZE_HASHED_NAMES=0)
endif()

if (OPTIMIZE_BINARY_SLICE)
    add_definitions(-DOPTIMIZE_BINARY_SLICE=1)
else()
    add_definitions(-DOPTIMIZE_BINARY_SLICE=0)
endif()

if (OPTIMIZE_BUILTIN_METHODS)
    add_definitions(-DOPTIMIZE_BUILTIN_METHODS=1)
else()
    add_definitions(-DOPTIMIZE_BUILTIN_METHODS=0)
endif()

if (OPTIMIZE_TYPESLOT_LOOKUPS)
    add_definitions(-DOPTIMIZE_TYPESLOT_LOOKUPS=1)
else()
    add_definitions(-DOPTIMIZE_TYPESLOT_LOOKUPS=0)
endif()

if (OPTIMIZE_FUNCTION_CALLS)
    add_definitions(-DOPTIMIZE_FUNCTION_CALLS=1)
else()
    add_definitions(-DOPTIMIZE_FUNCTION_CALLS=0)
endif()

if (OPTIMIZE_LOAD_ATTR)
    add_definitions(-DOPTIMIZE_LOAD_ATTR=1)
else()
    add_definitions(-DOPTIMIZE_LOAD_ATTR=0)
endif()

if (OPTIMIZE_METHOD_CALLS)
    add_definitions(-DOPTIMIZE_METHOD_CALLS=1)
else()
    add_definitions(-DOPTIMIZE_METHOD_CALLS=0)
endif()

if (OPTIMIZE_COMPARE)
    add_definitions(-DOPTIMIZE_COMPARE=1)
else()
    add_definitions(-DOPTIMIZE_COMPARE=0)
endif()

if (EE_DEBUG_CODE)
    add_definitions(-DEE_DEBUG_CODE=1)
endif()

if (DOTNET_PGO)
    add_definitions(-DDOTNET_PGO=1)
endif()

add_definitions(-DEMIT_PENDING_CALL_COUNTER=100)